<div class="fileUpload">
  <span>
    <button (click)="open(dialog)" nbButton status="basic">Arquivo</button>
  </span>

  <input type="text" nbInput [disabled]="true" [value]="arquivo?.nome" />

  <span class="btn-remover-file">
    <button (click)="removerSelect()" nbButton ghost status="danger">
      <nb-icon icon="trash-2-outline"></nb-icon>
    </button>
  </span>
</div>

<ng-template #dialog let-data let-ref="dialogRef">
  <nb-card class="size-600"
  nbSpinnerStatus="danger"
  nbSpinnerSize="large"
  nbSpinnerMessage=""
  [nbSpinner]="loadingCard"
  >
    <nb-card-header>Biblioteca de arquivos</nb-card-header>
    <nb-card-body>
      <div class="content-add-file">
        <p><strong>Enviar novos arquivos</strong></p>
        <button nbButton status="basic" (click)="openFileInput()">
          <span>Arquivo</span>
          <input
            type="file"
            #fileInput
            style="display: none"
            [accept]="accepts"
            (change)="openFile($event)"
          />
        </button>
        <input type="text" nbInput [disabled]="true" [value]="nameFile" />
        <span class="btn-send-file">
          <button
            (click)="upload()"
            [disabled]="!selectedFiles"
            nbButton
            status="primary"
          >
            Enviar
          </button>
        </span>
      </div>
      <hr style="margin-top: 16px; border: 1px solid #ebebeb" />
      <div class="content-all-files">
        <p><strong>Meus arquivos</strong></p>
        <div class="files">
          @for (item of midias; track item.id) {
          <nb-card class="files-card">
            <img class="img-file" [defaultImage]="defaultImage" [lazyLoad]="item.url" [alt]="item.nome" />
            <div class="botton-btn">
              <span class="btn-select-file">
                <button (click)="changeSelectFiles(item)" nbButton ghost status="success">
                  <nb-icon icon="checkmark-circle-outline"></nb-icon>
                </button>
              </span>
              <span class="btn-delete-file">
                <button (click)="deleteFile(item, dialogConfirm)" nbButton ghost status="danger">
                  <nb-icon icon="trash-2-outline"></nb-icon>
                </button>
              </span>
            </div>
          </nb-card>
          } @empty {
          <p>Ainda não há arquivos disponíveis.</p>
          }
        </div>
      </div>
    </nb-card-body>
    <nb-card-footer>
      <button nbButton (click)="ref.close()">Cancelar</button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<ng-template #dialogConfirm let-data2 let-ref2="dialogConfirmRef">
  <nb-card
  nbSpinnerStatus="danger"
  nbSpinnerSize="large"
  nbSpinnerMessage=""
  [nbSpinner]="loading">
    <nb-card-header>Atenção!</nb-card-header>
    <nb-card-body>Você deseja excluir este arquivo?</nb-card-body>
    <nb-card-footer>
      <button (click)="confirmDelete(data2)" type="button" status="primary" nbButton>
        Confirmar
      </button>
      <button type="button" nbButton (click)="closeDialog()">Cancelar</button>
    </nb-card-footer>
  </nb-card>
</ng-template>